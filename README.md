# 鄂尔多斯市统计列表个性化配置工具

## 功能特性

### 1. 多层级表头支持 ✅
- 支持无限层级的表头嵌套
- 自动计算单元格合并(colspan/rowspan)
- 表头层级可视化展示

### 2. 列配置功能 ✅
- 树形结构展示列配置
- 支持显示/隐藏各级列
- 支持拖拽调整列顺序
- 父子级联动控制

### 3. 样式配置功能 ✅
- **全局样式配置**:
  - 表头背景色、文字色、字体大小、字体粗细
  - 数据行背景色、文字色、字体大小
  - 边框颜色
  
- **单元格样式配置**:
  - 双击单元格进行单独样式设置
  - 支持每个单元格的背景色、文字色、字体大小、字体粗细
  - 实时预览样式效果

### 4. Excel 导出功能 ✅
- **导出列配置**:
  - 树形勾选导出列
  - 独立设置每列的导出宽度
  
- **导出样式配置**:
  - 表头背景色、文字色、字体大小
  - 数据行字体大小
  - 保留单元格自定义样式
  
- **导出特性**:
  - 多层级表头自动合并
  - 表头居中显示
  - 列宽自适应/手动设置
  - 保留所有自定义样式

### 5. 表格交互功能 ✅
- 固定第一列(管辖机构)
- 鼠标悬停高亮
- 双击单元格编辑样式
- 数值格式化显示
- 横向/纵向滚动支持

## 技术栈

- Vue 3 + Composition API
- Vite 5.x
- Element Plus 2.5
- xlsx 0.18.5
- Node.js 18+

## 项目结构

```
hdty-tool/
├── src/
│   ├── components/
│   │   ├── DataTable.vue           # 主表格组件
│   │   ├── ColumnConfigDialog.vue  # 列配置对话框
│   │   ├── StyleConfigDialog.vue   # 样式配置对话框
│   │   └── ExportConfigDialog.vue  # 导出配置对话框
│   ├── mock/
│   │   └── data.js                 # Mock数据(鄂尔多斯市各旗区统计数据)
│   ├── utils/
│   │   └── excelExport.js          # Excel导出工具
│   ├── App.vue
│   └── main.js
├── index.html
├── vite.config.js
└── package.json
```

## 安装和运行

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build

# 预览生产版本
npm run preview
```

## 使用说明

### 1. 列配置
点击"列配置"按钮,在弹出的对话框中:
- 勾选/取消勾选列来显示/隐藏
- 拖拽树节点调整列的顺序
- 父节点勾选会同步所有子节点

### 2. 样式配置
点击"样式配置"按钮,可以配置:
- **全局样式**: 应用到所有表头和数据行
- **单元格样式**: 双击表格单元格,在样式配置对话框中设置该单元格的独立样式

### 3. 导出Excel
点击"导出Excel"按钮:
- **导出列**: 选择要导出的列,设置每列的宽度
- **导出样式**: 配置导出文件的样式
- 点击"确认导出"生成Excel文件

## 数据说明

项目包含鄂尔多斯市及下辖9个旗区的统计数据:
- 鄂尔多斯市(汇总)
- 东胜区
- 康巴什区
- 伊金霍洛旗
- 达拉特旗
- 准格尔旗
- 鄂托克前旗
- 鄂托克旗
- 杭锦旗
- 乌审旗

统计维度包括:
- 单位类别(党政机关、驻华外事外交机构、城市中心广场、标志性建筑物等)
- 单位等级(Ⅰ级、Ⅱ级、Ⅲ级)

## 特色功能

1. **智能表头合并**: 自动计算多层级表头的colspan和rowspan
2. **拖拽排序**: 支持列的拖拽调整顺序
3. **单元格级样式**: 每个单元格都可以单独设置样式
4. **完整的导出**: Excel导出保留所有样式和表头层级
5. **固定列**: 第一列固定,横向滚动时始终可见
6. **响应式设计**: 自适应不同屏幕尺寸

## 浏览器支持

- Chrome (推荐)
- Edge
- Firefox
- Safari

## 开发者

项目采用 Vue 3 Composition API 编写,代码结构清晰,易于维护和扩展。
